<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
    <title>api-headers-form test</title>

    <script src="../node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
    <script src="../node_modules/@polymer/test-fixture/test-fixture.js"></script>
    <script src="../node_modules/mocha/mocha.js"></script>
    <script src="../node_modules/chai/chai.js"></script>
    <script src="../node_modules/wct-mocha/wct-mocha.js"></script>

    <script type="module" src="../api-headers-form.js"></script>
  </head>
  <body>

    <test-fixture id="basic">
      <template>
        <api-headers-form></api-headers-form>
      </template>
    </test-fixture>

    <script type="module">
    suite('Headers description test', () => {
      const model = [{
        binding: 'header',
        name: 'x-test',
        hasDescription: false,
        required: true,
        schema: {
          enabled: true,
          type: 'string',
          inputLabel: 'x-string',
          isEnum: false,
          isArray: false,
          isBool: false,
          inputType: 'text'
        },
        value: ''
      }, {
        binding: 'header',
        name: 'accept',
        hasDescription: false,
        required: true,
        schema: {
          enabled: true,
          type: 'string',
          inputLabel: 'x-string',
          isEnum: false,
          isArray: false,
          isBool: false,
          inputType: 'text'
        },
        value: ''
      }, {
        binding: 'header',
        name: 'content-type',
        hasDescription: true,
        description: 'test',
        required: true,
        schema: {
          enabled: true,
          type: 'string',
          inputLabel: 'x-string',
          isEnum: false,
          isArray: false,
          isBool: false,
          inputType: 'text'
        },
        value: ''
      }];
      let element;
      setup(() => {
        element = fixture('basic');
        element.model = model;
      });

      test('Adds description to the header', () => {
        assert.isTrue(element.model[1].hasDescription);
      });

      test('Description is set', () => {
        assert.typeOf(element.model[1].description, 'string');
      });

      test('Example is set', () => {
        assert.isAbove(element.model[1].schema.examples.length, 0);
      });

      test('Unknown headers are ignored', () => {
        assert.isFalse(element.model[0].hasDescription);
      });

      test('Model with description is ignored', () => {
        assert.equal(element.model[2].description, 'test');
      });
    });
    </script>
  </body>
</html>
